<app-user-header></app-user-header>
<!-- <div class="profile-banner" [ngClass]="{'profile-banner-mobile' : mobileView}"> -->
<!-- </div> -->

<div class='site-body' [ngClass]="mobileView ? 'mobile': 'desktop'">
  <div class="container">
    <div class="profile-page-container">
      <div class="user-profile-banner">
        <div class="com-ban-img-container"
          [ngClass]="[mobileView ? 'mobile': 'desktop', mobileView ? 'profile-banner-mobile' : '']">
          <img [src]="userBannerImage" alt="banner" class="comm-ban-img"
            [ngClass]="[mobileView ? 'mobile': 'desktop', userBannerImage ? '' : 'd-none']">
          <div *ngIf="isBannerLoding" class="banner-loading">
            <app-loader [size]="'md'" [color]="'dark'"></app-loader>
          </div>
          <div class="change-comm-img">
            <mat-icon (click)="previewImage()" *ngIf="relation == 'owned'">camera</mat-icon>
            <app-img-cropper-wrapper (imageDataEvent)="imageDataReceiverOfBanner($event)" [aspectRatio]="12 / 4"
              #userBannerImageCropperRef>
            </app-img-cropper-wrapper>
          </div>
        </div>
      </div>
      <div class="profile-section" [ngClass]="{'profile-section-mobile' : mobileView}">
        <div class="profile-img">
          <img [src]="userAvatarImage ? userAvatarImage : defaultUserSrc" alt="">
          <app-img-cropper-wrapper (imageDataEvent)="imageDataReceiver($event)" [aspectRatio]="4 / 4" #imageCropperRef>
          </app-img-cropper-wrapper>
          <!-- <input id="fileInput" type="file" style="display: none" (change)="updateUserAvatar($event)"> -->
          <div class="avatar" *ngIf="relation==='owned'">
            <mat-icon (click)="triggerFalseClick()">camera</mat-icon>
          </div>
        </div>
        <div class="profile-actions">
          <!--      <p>{{user?.username}}</p>-->
          <!--      <div _ngcontent-serverapp-c271="" style="-->
          <!--    position: absolute;-->
          <!--    bottom: 2%;-->
          <!--    font-size: 10px;-->
          <!--">Average joe with average dreams.-->
          <!--      </div>-->
          <p>
            {{user?.username}}
            <!--              <span> â—‹ </span><span style="font-size: 14px">{{user?.firstName}}&nbsp;{{user?.lastName}}</span>-->
          </p>
          <div class="actions">
            <button mat-stroked-button *ngIf="relation ==='owned'&& !mobileView " (click)="openEditDialog()">
              <mat-icon>edit</mat-icon>
              Edit Profile
            </button>
            <button mat-stroked-button *ngIf="relation ==='owned'&& mobileView " (click)="openEditDialog()">
              <mat-icon>edit</mat-icon>
            </button>
            <app-relation-action-button [username]="user?.username" [relation]="relation" [userId]="userId"
              [mobileView]="mobileView">
            </app-relation-action-button>
          </div>
        </div>
      </div>
      <div class="user-meta-info-div row" [ngClass]="mobileView ? 'mobile': 'desktop'">
        <div class="col-md-6">
          <app-user-description-card [bio]="user?.bio" [relation]="relation" [mobileView]="mobileView"
            [username]="user?.username">
          </app-user-description-card>
        </div>
        <div class="col-md-6">
          <app-user-activity [userId]="user?.userId" [userInfo]="userInfo"></app-user-activity>
        </div>
      </div>
      <div>
        <div class="profile-page-container" [ngClass]="{'profile-page-container-mobile' : mobileView}">
          <div class="flex">
            <div class="flex-section-left">
              <app-usercommunity [userId]="user?.userId" [relation]="relation"
                [ownsCommunities]="userInfo?.ownsCommunities">
              </app-usercommunity>
              <app-joined-community [userId]="user?.userId" [followsCommunities]="userInfo?.followsCommunities">
              </app-joined-community>
              <div *ngIf="!mobileView">
                <app-floating-footer></app-floating-footer>
              </div>
            </div>
            <div class="flex-section-center" id="user-feed">
              <app-post-feeds [mobileView]="mobileView" (postData)="postFeed($event)" [isCommunityPost]=false
                *ngIf="relation === 'owned'" [type]="'Create'">
              </app-post-feeds>
              <ng-container *ngIf="userFeeds?.length; else noFeeds">
                <div class="feed-wrap" *ngFor="let feed of userFeeds">
                  <div *ngIf="feed.postType !== 'question'">
                    <app-recommended-feeds (removePostEvent)="removePostNotify($event)" *ngIf="feed" [feed]="feed">
                    </app-recommended-feeds>
                  </div>
                  <div *ngIf="feed.postType === 'question'">
                    <app-question-ui [question]="feed" (removePostEvent)="removePostNotify($event)"></app-question-ui>
                  </div>
                  <!--              <app-recommended-feeds (removePostEvent)="removePostNotify($event)" *ngIf="feed" [feed]="feed">-->
                  <!--              </app-recommended-feeds>-->
                </div>
                <p class="text-center" *ngIf="feeds?.length===1 && feeds[0] === null">No Feeds Found...!</p>
              </ng-container>
              <app-feeds-loader *ngIf="loading"></app-feeds-loader>
              <ng-template #noFeeds>
                <p class="text-center" style="margin-top :30px" *ngIf="feeds?.length===1 && feeds[0] === null">No Feeds
                  Found...!</p>
              </ng-template>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<app-floating-mobile-nav [url]="url" *ngIf="mobileView"></app-floating-mobile-nav>