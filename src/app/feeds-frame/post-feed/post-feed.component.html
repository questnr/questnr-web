<div class="box">
  <div class="loader" [ngClass]="{'active': isLoading}">
    <mat-progress-bar *ngIf="!uploading && isLoading" mode="indeterminate"></mat-progress-bar>
    <mat-progress-bar *ngIf="uploading" mode="determinate" [value]="uploadProgress"></mat-progress-bar>
  </div>
  <div class="post-wrap">
    <div class="icon" [routerLink]="['/user/',login.getUserProfile().slug]"><img [src]="login.profileImg"></div>
    <div class="textbox-wrap md-form" style="position:relative;">
      <div *ngIf="!isBlogEditor">
        <textarea rows="4" placeholder="Post Something...." [formControl]="text" (input)="typeCheckOnUserInput($event)"
          (keyup)="typeCheckOnUserInput($event)" class="md-textarea md-textarea-auto" mdbInput #userInputRef>
      </textarea>
        <div class="emoticon-container">
          <app-emoticons (emojiData)="addEmoji($event)"></app-emoticons>
        </div>
      </div>
      <div *ngIf="isBlogEditor">
        <app-rich-text-area (typeCheckOnUserInputEvent)="typeCheckOnUserInputEvent($event)"
          (registerEditorEvent)="registerEditor($event)">
        </app-rich-text-area>
      </div>
      <span *ngIf="isBlogEditor" (click)="switchEditor(false)" class="editor-mode">switch to normal editor</span>
      <span *ngIf="!isBlogEditor" (click)="switchEditor(true)" class="editor-mode">switch to blog editor</span>
    </div>
  </div>

  <app-meta-card *ngIf="iFramelyData?.url" [iFramelyData]="iFramelyData"></app-meta-card>

  <div class="media" [@expand]="isMediaEnabled ? 'expanded' : 'collapsed'">
    <div class="media-wrap">
      <div class="media-item" *ngFor="let item of addedMedias; let i=index">
        <button mat-icon-button (click)="removeMedia(i)">
          <mat-icon>close</mat-icon>
        </button>
        <img *ngIf="addedMediaSrc[i]?.type.includes('image')" [src]="addedMediaSrc[i]?.src">
        <video *ngIf="addedMediaSrc[i]?.type.includes('video')">
          <source [src]="addedMediaSrc[i]?.src" [type]="addedMediaSrc[i].type">
        </video>
      </div>
      <div class="drop-area m-2" appDragDrop (fileDropped)="filesDropped($event)" (click)="fileInput.click()">
        <input type="file" (change)="selectFiles($event)" #fileInput style="display: none" multiple
          accept="image/*,video/*" />
        <div class="text-center">
          <mat-icon>add_photo_alternate</mat-icon>
          <div> Drop Image/Video</div>
        </div>
      </div>
    </div>
  </div>
  <div class="btn-wrap">
    <button mat-button (click)="toggleAddMedia()" [ngClass]="{ active: isMediaEnabled}">
      <mat-icon>add_a_photo</mat-icon>
      <span class="sm-d-none"> &nbsp; Photo/Video </span>
    </button>
    <!-- <button mat-button>
      <mat-icon>help</mat-icon> <span class="sm-d-none"> &nbsp; Ask a Question </span>
    </button> -->
    <div class="space"></div>
    <button mat-flat-button class="btn-post" (click)="postFeed()" [disabled]="isPostInvalid() || isLoading">
      <div *ngIf="isLoading" class="spinner-border spinner-border-sm" role="status">
        <span class="sr-only">Loading...</span>
      </div> &nbsp; Post &nbsp;
      <mat-icon>send</mat-icon>
    </button>
  </div>
</div>

<app-floating-suggestion-box #floatingSuggestionBoxRef>
</app-floating-suggestion-box>